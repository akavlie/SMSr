{% extends 'layout.html' %}

{% block body %}

<script type="text/javascript">
    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};

    $(function() {
        $('#test').click(function() {
            $('.sent_message:first').slideToggle(1000);
        });

        $("#sms_form").submit(function() {
            $.post("/sms", $("#sms_form").serialize(),
                function(data) {
                    $('#sent_message_list').prepend(data);
                    $('.sent_message:first').fadeIn(1000);
                });
            return false;
        });

    });

</script>

<button id="test">Test!</button>

<form id="sms_form" action="">
    <p><label for="phone">Phone Number: </label>
        <input type="text" name="phone_number" /></p>
    <p><label for="phone_number">Message: </label>
    <input type="text" name="message" />
    <input type="submit" value="Send" /></p>
</form>

<div id="test">
    <p id="status">null</p>
    <p id="phone">null</p>
    <p id="message">null</p>
</div>

    {% if sent_messages %}
        <h2>Message History</h2>
    <div id="sent_message_list">
        {% for message in sent_messages %}
        <div class="sent_message">
            <div class="status">{{ message.status }}</div>
            <div class="sent_body">
                <div class="phone">{{ message.phone }}</div>
                <div class="time">{{ message.date }}</div>
                <div class="clear"></div>
                <div class="message_text"><p>{{ message.message }}</p></div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    No messages yet!
    {% endif %}

{% endblock %}
